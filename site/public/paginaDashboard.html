<!DOCTYPE html>
<html lang="pt-br">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="./css/paginaDashboard.css">
  <link rel="icon" href="./assets/imgs/LOGOV2.png">
  <title>Dashboard</title>
</head>

<body onload="obterdados(idMaquina)">

  <header>
    <nav class="nav-bar">
      <div class="hamburger-menu">
        <input id="menu__toggle" type="checkbox" />
        <label class="menu__btn" for="menu__toggle">
          <span></span>
        </label>



        <ul class="menu__box">
          <div class="image">
            <img src="../public/assets/imgs/imagem-do-usuario-com-fundo-preto.png" alt=""
              style="height: 200px; width: 200px; border-radius: 50%; ">
          </div>
          <div class="nomeUser">
            <span>Nome adm</span>
          </div>
          <li><a class="menu__item" href="../public/cadastroEmpresa.html">Cadastro da empresa</a></li>
          <li><a class="menu__item" href="../public/areaADM.html">Home</a></li>
          <li><a class="menu__item" href="../public/cadastromaquina.html">Cadastrar maquina</a></li>
          <li><a class="menu__item" href="../public/cadastroFuncionario.html">Cadastrar funcionário</a></li>
          <li><a class="menu__item" href="#">Logout</a></li>
        </ul>
      </div>



      <div class="logo">
        <a href="./areaADM.html"><img src="assets/imgs/LOGOcomTextoV2.png" alt="" width="150px"></a>
      </div>
    </nav>

  </header>


  <section>
    <div class="main">
      <div class="container">
        <div class="btnNav">
          <div class="bloco" id="cantoTopLeft">
            <button onclick="drawChartCpu()" class="cpu" onmouseover="cpuIn()" onmouseout="cpuOut()">
              <h1 id="processadorTitulo">Processador</h1>
              <div class="container-image">
                <img src="./assets/imgs/cpu-normal.png" id="cpu_normal" width="75px" height="75px">
                <img src="./assets/imgs/cpu-hover.png" id="cpu_yellow" width="75px" style="display: none;">
              </div>
            </button>
          </div>
          <div class="bloco">
            <button onclick="drawChartRam()" class="ram" onmouseover="ramIn()" onmouseout="ramOut()">
              <h1 id="memoriaTitulo">Memória</h1>
              <div class="container-image">
                <img src="./assets/imgs/ram-normal.png" id="ram_normal" width="75px" height="75px">
                <img src="./assets/imgs/ram-hover.png" id="ram_yellow" width="75px" height="75px"
                  style="display: none;">
              </div>
            </button>
          </div>
          <div class="bloco">
            <button onclick="drawChartDisco()" onmouseover="discoIn()" onmouseout="discoOut()">
              <h1 id="discoTitulo">Disco</h1>
              <div class="container-image">
                <div class="container-image">
                  <img src="./assets/imgs/disk-normal.png" id="disco_normal" width="75px" height="75px">
                  <img src="./assets/imgs/disk-hover.png" id="disco_yellow" width="75px" height="75px"
                    style="display: none;">
                </div>
              </div>
            </button>
          </div>
          <div class="bloco">
            <button onclick="drawChartRede()" onmouseover="redeIn()" onmouseout="redeOut()">
              <h1 id="redeTitulo">Rede</h1>
              <div class="container-image">
                <div class="container-image">
                  <img src="./assets/imgs/rede-normal.png" id="rede_normal" width="75px" height="75px">
                  <img src="./assets/imgs/rede-hover.png" id="rede_yellow" width="75px" height="75px"
                    style="display: none;">
                </div>
              </div>
            </button>
          </div>
          <div class="bloco" id="cantoBotLeft">
            <button class="gear" onmouseover="confIn()" onmouseout="confOut()">
              <h1 id="confTitulo">Configurações</h1>
              <div class="container-image">
                <img src="./assets/imgs/conf-normal.png" id="conf_normal" width="75px" height="75px">
                <img src="./assets/imgs/conf-hover.png" id="conf_yellow" width="75px" height="75px"
                  style="display: none;">
              </div>
            </button>
          </div>
        </div>
        <div class="ladoB">
          <div class="containerGrafico" id="cantoTopRight">
            <div id="piechart" style="width: 900px; height: 500px;"></div>
          </div>
          <div class="metricasGrafico" id="cantoBotRight">
            <div id="fraseMetrica"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
</body>

</html>
<script>
  function cpuIn() {
    cpu_normal.style.display = 'none';
    cpu_yellow.style.display = 'block';
    processadorTitulo.style.color = '#F2CB05';
  }

  function cpuOut() {
    cpu_yellow.style.display = 'none';
    cpu_normal.style.display = 'block ';
    processadorTitulo.style.color = '#FFFFFF';
  }

  function ramIn() {
    ram_normal.style.display = 'none';
    ram_yellow.style.display = 'block';
    memoriaTitulo.style.color = '#F2CB05';
  }

  function ramOut() {
    ram_yellow.style.display = 'none';
    ram_normal.style.display = 'block ';
    memoriaTitulo.style.color = '#FFFFFF';
  }

  function discoIn() {
    disco_normal.style.display = 'none';
    disco_yellow.style.display = 'block';
    discoTitulo.style.color = '#F2CB05';
  }

  function discoOut() {
    disco_yellow.style.display = 'none';
    disco_normal.style.display = 'block ';
    discoTitulo.style.color = '#FFFFFF';
  }

  function redeIn() {
    rede_normal.style.display = 'none';
    rede_yellow.style.display = 'block';
    redeTitulo.style.color = '#F2CB05';
  }

  function redeOut() {
    rede_yellow.style.display = 'none';
    rede_normal.style.display = 'block ';
    redeTitulo.style.color = '#FFFFFF';
  }

  function confIn() {
    conf_normal.style.display = 'none';
    conf_yellow.style.display = 'block';
    confTitulo.style.color = '#F2CB05';
  }

  function confOut() {
    conf_yellow.style.display = 'none';
    conf_normal.style.display = 'block ';
    confTitulo.style.color = '#FFFFFF';
  }
</script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  
  // REDE
  var vetorHora = [];
  var vetorRedeUpload = [];
  var vetorRedeDownload = [];
  
  //PROCESSADOR
  var vetorPorcentagemCpu = [];
  var vetorHorasPorcentagem = [];
  
  //TEMPERATURA
  var temperatura = [];

  // DISCO
  var capacidadeDiscoTotal = 0;
  var capacidadeDiscoLivre = 0;

  // RAM 
  var CapacidadeRamTotal = 0;
  var CapacidadeRamEmUso = 0;

  
  // MÉTRICA
  var metrica = {
      Processador: "",
      Ram: "",
      Disco: ""
  }

  // var idMaquina = sessionStorage.ID_MAQUINA;
  var idMaquina = 1;

  var confidencial = "";

  function obterdados(idMaquina) {
    fetch(`/dados/tempo-real/${idMaquina}`)
      .then(resposta => {

        if (resposta.ok) {
          resposta.json().then(resposta => {

            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

            for (i = 0; i < resposta.length; i++) {
              var registro = resposta[i];
              
              // HORÁRIO (Para parametros)
              vetorHora.push(registro.horario);

              // REDE (Banco)
              vetorRedeDownload.push(registro.download);
              vetorRedeUpload.push(registro.upload);
              
              // CPU (Banco)
              vetorHorasPorcentagem.push(registro.horario);
              vetorPorcentagemCpu.push(registro.cpuuso);
              
              // TEMPERATURA (Banco)
              temperatura.push(registro.temperatura);

              // DISCO (Banco)
              capacidadeDiscoLivre = registro.discolivre;
              capacidadeDiscoTotal = registro.discoTotal;
              
              // RAM (Banco)
              CapacidadeRamTotal = registro.ramTotal;
              CapacidadeRamEmUso = registro.ramUso;
              
              
              // MÉTRICA (Banco)
              metrica.Processador = registro.processadorMetrica;
              metrica.Ram = registro.ramMetrica;
              metrica.Disco = registro.discoMetrica;
              
            }
          });
        } else {

          console.error('Nenhum dado encontrado ou erro na API');
        }
      })
      .catch(function (error) {
        console.error(`Erro na obtenção dos dados do aquario p/ gráfico: ${error.message}`);
      });

  }

  // Gráfico Rede
  google.charts.load('current', { 'packages': ['corechart'] });
  google.charts.setOnLoadCallback(drawChartRede);


  function drawChartRede() {
    var data = google.visualization.arrayToDataTable([
      ['horário', 'Upload', 'Download'],
      [vetorHora[0], vetorRedeUpload[0], vetorRedeDownload[0]],
      [vetorHora[1], vetorRedeUpload[1], vetorRedeDownload[1]],
      [vetorHora[2], vetorRedeUpload[2], vetorRedeDownload[2]],
      [vetorHora[3], vetorRedeUpload[3], vetorRedeDownload[3]],
      [vetorHora[4], vetorRedeUpload[4], vetorRedeDownload[4]],
      [vetorHora[5], vetorRedeUpload[5], vetorRedeDownload[5]],
      [vetorHora[6], vetorRedeUpload[6], vetorRedeDownload[6]],
      [vetorHora[7], vetorRedeUpload[7], vetorRedeDownload[7]],
      [vetorHora[8], vetorRedeUpload[8], vetorRedeDownload[8]],
      [vetorHora[9], vetorRedeUpload[9], vetorRedeDownload[9]],

    ]);

    var options = {
      title: 'Internet em kbps',
      curveType: 'function',
      legend: { position: 'bottom' }
    };

    var chart = new google.visualization.LineChart(document.getElementById('piechart'));
    // confidencial = document.getElementById("redeTitulo");
    fraseMetrica.innerHTML = `Dados Rede 
    <br>Enviar: 
    <br>Receber: `;

    chart.draw(data, options);
  }

  // Gráfico RAM
  google.charts.load('current', { 'packages': ['corechart'] });
  google.charts.setOnLoadCallback(drawChartRam);




  function drawChartRam() {

    var data = google.visualization.arrayToDataTable([
      ['', ''],
      ['Em uso', CapacidadeRamEmUso],
      ['Total', CapacidadeRamTotal]
    ]);

    var options = {
      title: 'Uso de RAM:'
    };

    var chart = new google.visualization.PieChart(document.getElementById('piechart'));
    fraseMetrica.innerHTML = `Dados RAM 
    <br>Em uso: 
    <br>Disponível:`;
    chart.draw(data, options);
  }



  // Gráfico CPU
  google.charts.load('current', { 'packages': ['corechart'] });
  google.charts.setOnLoadCallback(drawChartCpu);




  function drawChartCpu() {
    vetorHorasPorcentagem = ['12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00'];
    var data = google.visualization.arrayToDataTable([
      ['Horário', 'Porcentagem %', 'Sales'],
      [vetorHora[0],vetorHorasPorcentagem[0], vetorPorcentagemCpu[0]],
      [vetorHora[1],vetorHorasPorcentagem[1], vetorPorcentagemCpu[1]],
      [vetorHora[2],vetorHorasPorcentagem[2], vetorPorcentagemCpu[2]],
      [vetorHora[3],vetorHorasPorcentagem[3], vetorPorcentagemCpu[3]],
      [vetorHora[4],vetorHorasPorcentagem[4], vetorPorcentagemCpu[4]],
      [vetorHora[5],vetorHorasPorcentagem[5], vetorPorcentagemCpu[5]],
      [vetorHora[6],vetorHorasPorcentagem[6], vetorPorcentagemCpu[6]],
      [vetorHora[7],vetorHorasPorcentagem[7], vetorPorcentagemCpu[7]],
      [vetorHora[8],vetorHorasPorcentagem[8], vetorPorcentagemCpu[8]],
      [vetorHora[9],vetorHorasPorcentagem[9], vetorPorcentagemCpu[9]],


    ]);

    var options = {
      title: 'Company Performance',
      curveType: 'function',
      legend: { position: 'bottom' }
    };


    var chart = new google.visualization.LineChart(document.getElementById('piechart'));
    // confidencial = document.getElementById("processadorTitulo");
    fraseMetrica.innerHTML = `Dados Processador 
    <br>Utilização: `;

    chart.draw(data, options);
  }




  //Gráfico Disco
  google.charts.load('current', { 'packages': ['corechart'] });
  google.charts.setOnLoadCallback(drawChartDisco);

  function drawChartDisco() {

    var data = google.visualization.arrayToDataTable([
      ['Disco', 'Memória'],
      ['Capacidade em uso', capacidadeDiscoTotal],
      ['Capacidade livre', capacidadeDiscoLivre],

    ]);

    var options = {
      title: 'Disco:'
    };

    var chart = new google.visualization.PieChart(document.getElementById('piechart'));
    fraseMetrica.innerHTML = `Dados Disco 
    <br> Capacidade Total: ${capacidadeDiscoTotal}
    <br> Capacidade em uso: ${capacidadeDiscoLivre}`;
    chart.draw(data, options);
  } 
</script>