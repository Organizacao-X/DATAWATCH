<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>DATAWATCH | Administração</title>

    <script src="./js/funcoes.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    

    <link rel="icon" href="./assets/imgs/LOGOV2.png">
    <link rel="stylesheet" href="./css/areaADM.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
</head>

<body onload="mostrarConteudo()" onload="drawChart()">
    <!-- NAVBAR -->
    <header>
        <nav class="nav-bar">
            <div class="hamburger-menu">
                <input id="menu__toggle" type="checkbox" />
                <label class="menu__btn" for="menu__toggle">
                    <span></span>
                </label>



                <ul class="menu__box">
                    <div class="image">
                        <img src="../public/assets/imgs/imagem-do-usuario-com-fundo-preto.png" alt=""
                            style="height: 200px; width: 200px; border-radius: 50%; ">
                    </div>
                    <div class="nomeUser">
                        <span>Nome adm</span>
                    </div>
                    <li><a class="menu__item" href="../public/cadastroEmpresa.html">Cadastro da empresa</a></li>
                    <li><a class="menu__item" href="../public/areaADM.html">Home</a></li>
                    <li><a class="menu__item" href="../public/cadastromaquina.html">Cadastrar maquina</a></li>
                    <li><a class="menu__item" href="../public/cadastroFuncionario.html">Cadastrar funcionário</a></li>
                    <li><a class="menu__item" href="#">Logout</a></li>
                </ul>
            </div>



            <div class="logo">
                <img src="assets/imgs/LOGOcomTextoV2.png" alt="" width="150px">
            </div>
        </nav>

    </header>

    <div class="teste" id="conteudo_maquinas_funcionarios">
    <section>
            <div class="usuario">
                <span>Seja bem vindo <span id="nome_usuario"></span> </span>
            </div>

            <div class="bg">
                <div class="container">
                    <h2>Maquina</h2>
                    <ul class="cards">
                        <li class="card">
                            <div>
                                <h3 class="card-title">Maquina 1</h3>
                                

                            </div>
                            <div class="card-link-wrapper">
                                
                                <div id="piechart" style="width: 150px; height: 150px;"></div>
                                
                                <div class="status"></div><span>Ativa</span>
                            </div>
                        </li>
                        <li class="card">
                            <div>
                                <h3 class="card-title">Maquina 2</h3>
                                <div class="card-content">

                                </div>
                            </div>
                            <div class="card-link-wrapper">
                                <div class="status"></div><span>Ativa</span>
                            </div>
                        </li>
                        <li class="card">
                            <div>
                                <h3 class="card-title">Maquina 3</h3>
                                <div class="card-content">

                                </div>
                            </div>
                            <div class="card-link-wrapper">
                                <div class="status"></div><span>Ativa</span>
                            </div>
                        </li>
                        <li class="card">
                            <div>
                                <h3 class="card-title">Maquina 4</h3>
                                <div class="card-content">

                                </div>
                            </div>
                            <div class="card-link-wrapper">
                                <div class="status"></div><span>Ativa</span>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
    </section>


    <section>
        <div class="bg">
            <div class="container">
                <h2>Funcionário</h2>
                <ul class="cards">
                    <li class="card">
                        <div>
                            <h3 class="card-title">Funcionário 1</h3>

                        </div>
                        <div class="card-link-wrapper">
                            <div class="status"></div><span>Online</span>
                        </div>
                    </li>
                    <li class="card">
                        <div>
                            <h3 class="card-title">Funcionário 2</h3>
                            <div class="card-content">

                            </div>
                        </div>
                        <div class="card-link-wrapper">
                            <div class="status2"></div><span>Offline</span>
                        </div>
                    </li>
                    <li class="card">
                        <div>
                            <h3 class="card-title">Funcionário 3</h3>
                            <div class="card-content">

                            </div>
                        </div>
                        <div class="card-link-wrapper">
                            <div class="status2"></div><span>Offline</span>
                        </div>
                    </li>
                    <li class="card">
                        <div>
                            <h3 class="card-title">Funcionário 4</h3>
                            <div class="card-content">

                            </div>
                        </div>
                        <div class="card-link-wrapper">
                            <div class="status"></div><span>Online</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </section>
</div>



</body>
<script type="text/javascript">

    // nomeUsuario.innerHTML = `<p>${sessionStorage.NOME_USUARIO}</p>`

    function cadastrosvisiveis() {

        if (sessionStorage.ID_EMPRESA != 0 || sessionStorage.ID_EMPRESA == undefined || sessionStorage.ID_EMPRESA == null) {
            funcionario.style.visibility = 'visible'
            maquina.style.visibility = 'visible'
        }
    }

    function mostrarConteudo() {
        fetch("/datawatch/consultarStatusEmpresa", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idUsuarioServer: sessionStorage.ID_USUARIO
            })
        }).then(function (resposta) {

            if (resposta.ok) {
                resposta.json().then(dados => {
                    console.log(dados)
                    // verifica se existe alguma empresa relacionada com esse usuário no banco de dados
                    // mostra o conteúdo da tela caso exista, não mostra caso não exista
                    if (dados.length == 0) {
                        alert("Nenhuma empresa cadastrada")
                    } else if (dados[0].verificado == 0) {
                        alert("Empresa ainda nao foi verificada")
                        conteudo_maquinas_funcionarios.style.display = "none"
                    } else {
                        var idEmpresa = dados[0].fkEmpresa;
                        conteudo_maquinas_funcionarios.style.display = "block"
                        nome_usuario.innerHTML = dados[0].nomeUsuario
                        // TODO:
                        // function para colocar os cards de máquinas e de funcionários nas respectivas divs
                        // responsável: Victor?
                        mostrarMaquinasFuncionarios(idEmpresa);
                    }
                })
            }
            else {
                throw (JSON.stringify(resposta))
            }
        }).catch(function (resposta) {
            console.log(`ERRO: ${resposta}`);
        })
        return false
    }
    
    // Gráficos 
    
    google.charts.load('current', { 'packages': ['corechart'] });
  google.charts.setOnLoadCallback(drawChartRede);

  function drawChartRede() {
    var data = google.visualization.arrayToDataTable([
      ['Minutos', 'Tempo em Atividade'],
      ['', 0],
      ['', 88],
      ['', 144],
      ['', 0],
      ['', 32]
    ]);

    var options = {
      title: 'Internet em kbps',
      curveType: 'function',
      legend: { position: 'bottom' }
    };

    var chart = new google.visualization.LineChart(document.getElementById('piechart'));
    // confidencial = document.getElementById("RedeTitulo");
    

    chart.draw(data, options);
  }
</script>